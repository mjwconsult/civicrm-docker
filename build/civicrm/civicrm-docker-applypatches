#!/bin/bash

set -e

CIVICRM_CORE_PATH="/var/www/html/core"
CIVICRM_PATCHES_PATH="/var/www/patches"

cd ${CIVICRM_CORE_PATH} || exit 1
echo `date` > "${CIVICRM_PATCHES_PATH}/patchlog.log"
for i in ${CIVICRM_PATCHES_PATH}/*.diff; do (echo $i; patch -p1 < $i) | tee -a "${CIVICRM_PATCHES_PATH}/patchlog.log"; done
